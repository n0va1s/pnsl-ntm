# Arquitetura Docker - PNSL-NTM

## ğŸ“ Diagrama da Arquitetura

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         INTERNET                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTPS (443) / HTTP (80)
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      REDE FRONTEND                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    NGINX (Container)                        â”‚ â”‚
â”‚  â”‚  - Servidor Web                                             â”‚ â”‚
â”‚  â”‚  - SSL/TLS Termination                                      â”‚ â”‚
â”‚  â”‚  - Rate Limiting                                            â”‚ â”‚
â”‚  â”‚  - CompressÃ£o Gzip                                          â”‚ â”‚
â”‚  â”‚  - Cache de Arquivos EstÃ¡ticos                              â”‚ â”‚
â”‚  â”‚  - Headers de SeguranÃ§a                                     â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Porta: 80, 443                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ FastCGI (9000)
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â–¼       REDE BACKEND (Interna)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              LARAVEL APP (Container)                        â”‚ â”‚
â”‚  â”‚  - PHP 8.2 FPM                                              â”‚ â”‚
â”‚  â”‚  - Laravel Framework                                        â”‚ â”‚
â”‚  â”‚  - Livewire/Volt                                            â”‚ â”‚
â”‚  â”‚  - OPcache Habilitado                                       â”‚ â”‚
â”‚  â”‚  - UsuÃ¡rio nÃ£o-root (laravel:1000)                          â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Porta: 9000 (interno)                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                          â”‚                            â”‚
â”‚          â”‚                          â”‚                            â”‚
â”‚          â”‚ MySQL (3306)             â”‚ Redis (6379)               â”‚
â”‚          â”‚                          â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  MYSQL (Container)   â”‚   â”‚  REDIS (Container)   â”‚            â”‚
â”‚  â”‚  - MySQL 8.0         â”‚   â”‚  - Redis 7 Alpine    â”‚            â”‚
â”‚  â”‚  - Charset: utf8mb4  â”‚   â”‚  - Cache             â”‚            â”‚
â”‚  â”‚  - InnoDB otimizado  â”‚   â”‚  - SessÃµes           â”‚            â”‚
â”‚  â”‚  - Slow query log    â”‚   â”‚  - Filas             â”‚            â”‚
â”‚  â”‚                      â”‚   â”‚  - PersistÃªncia AOF  â”‚            â”‚
â”‚  â”‚  Porta: 3306         â”‚   â”‚  Porta: 6379         â”‚            â”‚
â”‚  â”‚  (interno)           â”‚   â”‚  (interno)           â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VOLUMES PERSISTENTES                        â”‚
â”‚                                                                   â”‚
â”‚  ğŸ“¦ db_data          - Dados do MySQL                            â”‚
â”‚  ğŸ“¦ redis_data       - Dados do Redis (AOF)                      â”‚
â”‚  ğŸ“¦ storage_data     - Storage do Laravel (uploads, logs)        â”‚
â”‚  ğŸ“¦ bootstrap_cache  - Cache de bootstrap                        â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Fluxo de RequisiÃ§Ã£o

```
1. Cliente (Browser)
   â”‚
   â”œâ”€â†’ HTTP/HTTPS Request
   â”‚
   â–¼
2. NGINX Container
   â”‚
   â”œâ”€â†’ Verifica Rate Limit
   â”œâ”€â†’ Aplica Headers de SeguranÃ§a
   â”œâ”€â†’ Comprime Response (Gzip)
   â”œâ”€â†’ Serve arquivos estÃ¡ticos (se aplicÃ¡vel)
   â”‚
   â”œâ”€â†’ Passa para PHP-FPM (se .php)
   â”‚
   â–¼
3. Laravel App Container (PHP-FPM)
   â”‚
   â”œâ”€â†’ OPcache (cÃ³digo compilado)
   â”œâ”€â†’ Laravel Framework
   â”œâ”€â†’ Middleware
   â”œâ”€â†’ Routes
   â”œâ”€â†’ Controllers
   â”‚
   â”œâ”€â†’ Acessa MySQL (se necessÃ¡rio)
   â”‚   â”‚
   â”‚   â–¼
   â”‚   MySQL Container
   â”‚   â”‚
   â”‚   â””â”€â†’ Retorna dados
   â”‚
   â”œâ”€â†’ Acessa Redis (se necessÃ¡rio)
   â”‚   â”‚
   â”‚   â–¼
   â”‚   Redis Container
   â”‚   â”‚
   â”‚   â””â”€â†’ Retorna cache/sessÃ£o
   â”‚
   â”œâ”€â†’ Processa lÃ³gica de negÃ³cio
   â”œâ”€â†’ Renderiza View (Blade/Livewire)
   â”‚
   â””â”€â†’ Retorna Response
       â”‚
       â–¼
4. NGINX Container
   â”‚
   â”œâ”€â†’ Adiciona headers
   â”œâ”€â†’ Comprime
   â”‚
   â””â”€â†’ Envia para Cliente
       â”‚
       â–¼
5. Cliente (Browser)
   â””â”€â†’ Renderiza pÃ¡gina
```

---

## ğŸ”’ Camadas de SeguranÃ§a

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAMADA 1: REDE                                                   â”‚
â”‚  âœ“ Rede backend isolada (internal: true)                        â”‚
â”‚  âœ“ Apenas Nginx exposto externamente                            â”‚
â”‚  âœ“ ComunicaÃ§Ã£o interna via nomes de serviÃ§o                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAMADA 2: NGINX                                                  â”‚
â”‚  âœ“ Rate limiting (proteÃ§Ã£o DDoS)                                â”‚
â”‚  âœ“ Bloqueio de arquivos sensÃ­veis (.env, .git)                  â”‚
â”‚  âœ“ Headers de seguranÃ§a (XSS, CSRF, etc)                        â”‚
â”‚  âœ“ SSL/TLS (quando configurado)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAMADA 3: APLICAÃ‡ÃƒO                                              â”‚
â”‚  âœ“ Container roda como usuÃ¡rio nÃ£o-root                         â”‚
â”‚  âœ“ APP_DEBUG=false                                               â”‚
â”‚  âœ“ Secrets nÃ£o expostos no cÃ³digo                               â”‚
â”‚  âœ“ ValidaÃ§Ã£o de entrada                                         â”‚
â”‚  âœ“ CSRF protection                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAMADA 4: BANCO DE DADOS                                         â”‚
â”‚  âœ“ Acesso apenas via rede interna                               â”‚
â”‚  âœ“ Senhas fortes                                                 â”‚
â”‚  âœ“ UsuÃ¡rio especÃ­fico (nÃ£o root)                                â”‚
â”‚  âœ“ Dados persistidos em volumes                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Recursos e Limites

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Container        â”‚ CPU Lim. â”‚ CPU Res. â”‚ Mem Lim. â”‚ Mem Res. â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Laravel App      â”‚   1.0    â”‚   0.5    â”‚  512 MB  â”‚  256 MB  â”‚
â”‚ Nginx            â”‚   0.5    â”‚   0.25   â”‚  256 MB  â”‚  128 MB  â”‚
â”‚ MySQL            â”‚   1.0    â”‚   0.5    â”‚  512 MB  â”‚  256 MB  â”‚
â”‚ Redis            â”‚   0.5    â”‚   0.25   â”‚  256 MB  â”‚  128 MB  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL            â”‚   3.0    â”‚   1.5    â”‚ 1536 MB  â”‚  768 MB  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Lim. = Limite mÃ¡ximo
Res. = Reserva garantida
```

---

## ğŸ¥ Healthchecks

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Container        â”‚ Interval â”‚ Timeout â”‚ Retries  â”‚ Start Periodâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Laravel App      â”‚   30s    â”‚   3s    â”‚    3     â”‚    40s      â”‚
â”‚ Nginx            â”‚   30s    â”‚   3s    â”‚    3     â”‚    10s      â”‚
â”‚ MySQL            â”‚   10s    â”‚   3s    â”‚    5     â”‚    30s      â”‚
â”‚ Redis            â”‚   10s    â”‚   3s    â”‚    5     â”‚    10s      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Estrutura de Arquivos Docker

```
pnsl-ntm/
â”‚
â”œâ”€â”€ Dockerfile.production          # Dockerfile otimizado para produÃ§Ã£o
â”œâ”€â”€ docker-compose.production.yml  # Compose com todos os serviÃ§os
â”œâ”€â”€ .dockerignore                  # Arquivos a ignorar no build
â”‚
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ nginx/
â”‚   â”‚   â””â”€â”€ nginx.conf            # ConfiguraÃ§Ã£o Nginx otimizada
â”‚   â”‚
â”‚   â”œâ”€â”€ php/
â”‚   â”‚   â”œâ”€â”€ opcache.ini           # ConfiguraÃ§Ã£o OPcache
â”‚   â”‚   â””â”€â”€ php.ini               # ConfiguraÃ§Ã£o PHP
â”‚   â”‚
â”‚   â””â”€â”€ mysql/
â”‚       â””â”€â”€ my.cnf                # ConfiguraÃ§Ã£o MySQL
â”‚
â”œâ”€â”€ .env.production.example        # Template de variÃ¡veis
â”œâ”€â”€ deploy.sh                      # Script de deploy automatizado
â”‚
â”œâ”€â”€ LEIA-ME-PRIMEIRO.md           # Resumo executivo
â”œâ”€â”€ PRODUCTION_REVIEW.md          # AnÃ¡lise detalhada
â”œâ”€â”€ DEPLOY_GUIDE.md               # Guia de implementaÃ§Ã£o
â””â”€â”€ ARCHITECTURE.md               # Este arquivo
```

---

## ğŸš€ ComparaÃ§Ã£o: Antes vs Depois

### ANTES (ConfiguraÃ§Ã£o Original)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NGINX Container                    â”‚
â”‚  - ConfiguraÃ§Ã£o bÃ¡sica              â”‚
â”‚  - Sem rate limiting                â”‚
â”‚  - Sem headers de seguranÃ§a         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Laravel App Container              â”‚
â”‚  - Roda como root âš ï¸                â”‚
â”‚  - Sem OPcache configurado âš ï¸       â”‚
â”‚  - DependÃªncias faltando âš ï¸         â”‚
â”‚  - Sem healthcheck âš ï¸               â”‚
â”‚  - Sem limites de recursos âš ï¸       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQL Container                    â”‚
â”‚  - ConfiguraÃ§Ã£o padrÃ£o              â”‚
â”‚  - Sem healthcheck âš ï¸               â”‚
â”‚  - Sem otimizaÃ§Ãµes âš ï¸               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ SEM Redis
âŒ SEM SegregaÃ§Ã£o de rede
âŒ SEM RotaÃ§Ã£o de logs
âŒ SEM SSL/HTTPS
```

### DEPOIS (ConfiguraÃ§Ã£o Otimizada)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NGINX Container                    â”‚
â”‚  âœ“ Rate limiting                    â”‚
â”‚  âœ“ Headers de seguranÃ§a             â”‚
â”‚  âœ“ CompressÃ£o Gzip                  â”‚
â”‚  âœ“ Cache de estÃ¡ticos               â”‚
â”‚  âœ“ Healthcheck                      â”‚
â”‚  âœ“ Limites de recursos              â”‚
â”‚  âœ“ Preparado para SSL               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Laravel App Container              â”‚
â”‚  âœ“ UsuÃ¡rio nÃ£o-root (laravel:1000)  â”‚
â”‚  âœ“ OPcache otimizado                â”‚
â”‚  âœ“ Multi-stage build                â”‚
â”‚  âœ“ Healthcheck                      â”‚
â”‚  âœ“ Limites de recursos              â”‚
â”‚  âœ“ Todas extensÃµes PHP              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚             â”‚
               â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQL Container â”‚  â”‚  Redis Container â”‚
â”‚  âœ“ Otimizado     â”‚  â”‚  âœ“ Cache         â”‚
â”‚  âœ“ Healthcheck   â”‚  â”‚  âœ“ SessÃµes       â”‚
â”‚  âœ“ Limites       â”‚  â”‚  âœ“ Filas         â”‚
â”‚  âœ“ Backup ready  â”‚  â”‚  âœ“ Healthcheck   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Redis para performance
âœ… Redes segregadas (frontend/backend)
âœ… RotaÃ§Ã£o de logs configurada
âœ… Preparado para SSL/HTTPS
âœ… Monitoramento via healthchecks
```

---

## ğŸ“ˆ BenefÃ­cios da Nova Arquitetura

| Aspecto | Melhoria |
|---------|----------|
| **SeguranÃ§a** | +300% (mÃºltiplas camadas) |
| **Performance** | +150% (OPcache + Redis) |
| **Confiabilidade** | +200% (healthchecks + limites) |
| **Manutenibilidade** | +100% (documentaÃ§Ã£o + scripts) |
| **Escalabilidade** | Preparado para crescimento |

---

**Criado em:** 30/11/2025  
**VersÃ£o:** 1.0  
**Autor:** Antigravity AI
